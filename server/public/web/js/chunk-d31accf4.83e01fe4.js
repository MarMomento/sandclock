(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d31accf4"],{2381:function(e,t,n){"use strict";n("5c08")},"38c8":function(e,t,n){"use strict";var c=n("1da1"),r=(n("96cf"),n("caad"),n("2532"),n("79f6")),a=n("565a"),i=n("0ef5"),o=n("7a23"),u=n("6c02"),l=n("5502"),s=function(e){var t=Object(u["e"])(),n=Object(l["b"])(),s=Object(o["g"])((function(){return n.state.user})),b=Object(o["g"])((function(){var t;return(null===(t=s.value.info)||void 0===t?void 0:t._id)===(null===e||void 0===e?void 0:e.value)})),m=Object(o["g"])({get:function(){return!!s.value.info&&s.value.info.following.includes(e?e.value:"")},set:function(e){return e}});e&&Object(o["O"])(e,(function(e){s.value.info?m.value=s.value.info.following.includes(e):m.value=!1}));var d=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(c,o){var u,l,b,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s.value.isLogin){e.next=3;break}return t.push("/login"),e.abrupt("return");case 3:if(e.prev=3,!c){e.next=12;break}return e.next=7,Object(r["E"])(o._id);case 7:u=e.sent,l=u.status,204===l&&Object(a["a"])({type:"success",message:"取消关注成功"}),e.next=17;break;case 12:return e.next=14,Object(r["w"])(o._id);case 14:b=e.sent,m=b.status,204===m&&Object(a["a"])({type:"success",message:"关注成功"});case 17:n.dispatch(i["a"].FETCH_CURRENT_USER),e.next=22;break;case 20:e.prev=20,e.t0=e["catch"](3);case 22:case"end":return e.stop()}}),e,null,[[3,20]])})));return function(t,n){return e.apply(this,arguments)}}();return{user:s,isMe:b,isFollowing:m,followTheUser:d}};t["a"]=s},"3c34":function(e,t,n){"use strict";n("3f1a")},"3f1a":function(e,t,n){},"5c08":function(e,t,n){},"5c2f":function(e,t,n){"use strict";n("6c01")},"6c01":function(e,t,n){},7801:function(e,t,n){"use strict";n("aff5"),n("a9e3"),n("99af");var c=n("1e71"),r=function(){var e=[l("用户名")],t=[l("密码")],n=[l("密码")],r=[l("标签"),s(1,4)],a=[l("标题")],i=[l("文章内容")],o=[l("邮箱"),{type:c["a"].EMAIL,message:"请输入合法的邮箱"}],u=[l("搜索内容")];function l(e){return{type:c["a"].REQUIRED,message:"".concat(e,"不能为空")}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;return{type:c["a"].RANGE,message:"数量/长度只能在".concat(e,"-").concat(t),min:e,max:t}}return{nameRules:e,passwordRules:t,againPwdRules:n,tagRules:r,titleRules:a,contentRules:i,emailRules:o,searchRules:u}};t["a"]=r},"7d5f":function(e,t,n){"use strict";var c=n("7a23"),r={class:"list"},a={class:"list-body"};function i(e,t,n,i,o,u){return Object(c["x"])(),Object(c["i"])("div",r,[Object(c["E"])(e.$slots,"header"),Object(c["l"])("div",a,[Object(c["E"])(e.$slots,"list")])])}var o=Object(c["m"])({name:"List"});o.render=i;t["a"]=o},"927c":function(e,t,n){"use strict";n.r(t);var c=n("7a23"),r=Object(c["T"])("data-v-5d4052c3");Object(c["A"])("data-v-5d4052c3");var a={class:"container article-detail-page py-3"},i={class:"row"},o={class:"offset-lg-1 col-lg-8 offset-md-1 col-md-11 col-12"},u={class:"col-lg-3 col-md-12 col-sm-12 d-none d-md-block mt-md-3 mt-lg-0"};Object(c["y"])();var l=r((function(e,t,n,r,l,s){var b=Object(c["F"])("ArticleCard"),m=Object(c["F"])("CommentList"),d=Object(c["F"])("AuthorProfileCard");return Object(c["x"])(),Object(c["i"])("div",a,[Object(c["l"])("div",i,[Object(c["l"])("div",o,[e.article?(Object(c["x"])(),Object(c["i"])(b,{key:0,article:e.article,isDetail:!0,onCollectArticle:e.collectArticle,onStarArticle:e.starArticle},null,8,["article","onCollectArticle","onStarArticle"])):Object(c["j"])("",!0),e.article?(Object(c["x"])(),Object(c["i"])(m,{key:1,class:"comment-area bg-white p-lg-5 p-3",article:e.article,commentList:e.commentList},null,8,["article","commentList"])):Object(c["j"])("",!0)]),Object(c["l"])("div",u,[e.article?(Object(c["x"])(),Object(c["i"])(d,{key:0,author:e.article.author,class:"mb-3",onFollowUser:e.followTheUser},null,8,["author","onFollowUser"])):Object(c["j"])("",!0)])])])})),s=n("1da1"),b=(n("96cf"),n("6c02")),m=n("79f6"),d=n("e3c1"),f=n("85bc"),j=(n("a4d3"),n("e01a"),Object(c["T"])("data-v-2aaafe12"));Object(c["A"])("data-v-2aaafe12");var O={class:"card-title d-flex"},p={class:"card-text align-self-end"},v={class:"card-text"};Object(c["y"])();var h=j((function(e,t,r,a,i,o){var u=Object(c["F"])("router-link"),l=Object(c["F"])("Card");return Object(c["x"])(),Object(c["i"])(l,{class:"author-profile-card"},{header:j((function(){return[]})),title:j((function(){return[Object(c["l"])("div",O,[Object(c["l"])(u,{to:"/profile/".concat(e.author._id)},{default:j((function(){return[Object(c["l"])("img",{src:e.author.avatar_url||n("c121"),style:{width:"50px"},class:"rounded-circle me-3"},null,8,["src"])]})),_:1},8,["to"]),Object(c["l"])("h4",p,[Object(c["l"])(u,{class:"text-decoration-none text-dark fw-bold",to:"/profile/".concat(e.author._id)},{default:j((function(){return[Object(c["k"])(Object(c["J"])(e.author.nickName),1)]})),_:1},8,["to"])])])]})),text:j((function(){return[Object(c["l"])("p",v,Object(c["J"])(e.author.description),1)]})),action:j((function(){return[Object(c["l"])("button",{type:"button",disabled:e.author._id===(e.user.info&&e.user.info._id),class:["btn w-100 py-2",e.isFollowing?"btn-primary":"btn-outline-primary"],onClick:t[1]||(t[1]=function(t){return e.followUser(e.author)})},Object(c["J"])(e.isFollowing?"已关注":"关注"),11,["disabled"])]})),_:1})})),x=n("12f9"),g=n("38c8"),y=Object(c["m"])({name:"AuthorProfileCard",components:{Card:x["a"]},props:{author:{type:Object,required:!0}},emits:["follow-user"],setup:function(e,t){var n=t.emit,r=Object(c["C"])(e.author._id),a=Object(g["a"])(r),i=a.user,o=a.isFollowing,u=function(e){n("follow-user",o.value,e)};return Object(c["O"])((function(){return e.author}),(function(e){r.value=e._id})),{user:i,isFollowing:o,followUser:u}}});n("9d94");y.render=h,y.__scopeId="data-v-2aaafe12";var w=y,_=(n("4de4"),n("5502")),C=n("565a"),k=n("0ef5"),R=function(){var e=Object(b["e"])(),t=Object(_["b"])(),n=Object(c["g"])((function(){return t.state.user})),r=function(){var c=Object(s["a"])(regeneratorRuntime.mark((function c(r,a){var i,o,u,l;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:if(n.value.isLogin){c.next=3;break}return e.push("/login"),c.abrupt("return");case 3:if(c.prev=3,!r){c.next=12;break}return c.next=7,Object(m["G"])(a._id);case 7:i=c.sent,o=i.status,204===o&&Object(C["a"])({type:"success",message:"取消点赞成功"}),c.next=17;break;case 12:return c.next=14,Object(m["B"])(a._id);case 14:u=c.sent,l=u.status,204===l&&Object(C["a"])({type:"success",message:"点赞成功"});case 17:t.dispatch(k["a"].FETCH_CURRENT_USER),c.next=22;break;case 20:c.prev=20,c.t0=c["catch"](3);case 22:case"end":return c.stop()}}),c,null,[[3,20]])})));return function(e,t){return c.apply(this,arguments)}}();function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter((function(t){var n=e.filter((function(e){var n;return(null===(n=e.reply_to)||void 0===n?void 0:n._id)===t._id}));return n.length&&(t.children=n),null===t.reply_to}))}return{starTheComment:r,formatToTree:a}},E=R,A=function(e){return{all:e=e||new Map,on:function(t,n){var c=e.get(t);c&&c.push(n)||e.set(t,[n])},off:function(t,n){var c=e.get(t);c&&c.splice(c.indexOf(n)>>>0,1)},emit:function(t,n){(e.get(t)||[]).slice().map((function(e){e(n)})),(e.get("*")||[]).slice().map((function(e){e(t,n)}))}}},F=A(),T="DESTROY_COMMENT_REPLY",L="UPDATE_AFTER_COMMENT_REPLY",S={class:"fs-4 fw-bold"};function P(e,t,n,r,a,i){var o=Object(c["F"])("CommentEditor"),u=Object(c["F"])("SubCommentList"),l=Object(c["F"])("List");return Object(c["x"])(),Object(c["i"])(l,{class:"comment-list"},{header:Object(c["P"])((function(){return[Object(c["l"])("p",S,"评论（"+Object(c["J"])(e.article.comment_count)+"）",1),Object(c["l"])(o,{article_id:e.article._id,class:"mb-lg-5 mb-3"},null,8,["article_id"])]})),list:Object(c["P"])((function(){return[(Object(c["x"])(!0),Object(c["i"])(c["a"],null,Object(c["D"])(e.commentList,(function(e){return Object(c["x"])(),Object(c["i"])(u,{key:e._id,expand:!0,comment:e},null,8,["comment"])})),128))]})),_:1})}var U=n("7d5f"),N={class:"comment-editor d-flex"},J={key:0,class:"me-3"},M={class:"mt-3"},D=Object(c["k"])(" 发表评论 "),q=Object(c["k"])(" 取消 ");function I(e,t,r,a,i,o){var u=Object(c["F"])("v-textarea"),l=Object(c["F"])("v-btn"),s=Object(c["F"])("v-form");return Object(c["x"])(),Object(c["i"])("div",N,[e.showAvatar?(Object(c["x"])(),Object(c["i"])("div",J,[Object(c["l"])("img",{src:e.user.info&&e.user.info.avatar_url||n("c121"),style:{width:"42px",height:"42px"},class:"rounded-circle border"},null,8,["src"])])):Object(c["j"])("",!0),Object(c["l"])(s,{class:"w-100",ref:"commentRef"},{default:Object(c["P"])((function(){return[Object(c["l"])(u,{modelValue:e.content,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.content=t}),placeholder:"添加评论",rules:e.contentRules},null,8,["modelValue","rules"]),Object(c["l"])("div",M,[Object(c["l"])(l,{color:"primary ",onClick:e.publish},{default:Object(c["P"])((function(){return[D]})),_:1},8,["onClick"]),e.isReply?(Object(c["x"])(),Object(c["i"])(l,{key:0,color:"secondary ms-3",onClick:e.cancel},{default:Object(c["P"])((function(){return[q]})),_:1},8,["onClick"])):Object(c["j"])("",!0)])]})),_:1},512)])}var B=n("7801"),$=Object(c["m"])({name:"CommentEditor",props:{showAvatar:{type:Boolean,default:!0},article_id:{type:String,required:!0},comment_id:{type:String,default:""}},emits:["publish-success"],setup:function(e){var t=Object(c["C"])(null),n=Object(c["C"])(""),r=Object(_["b"])(),a=Object(c["g"])((function(){return r.state.user})),i=Object(B["a"])(),o=i.contentRules,u=Object(c["C"])(!!e.comment_id),l=Object(b["e"])(),d=function(){var c=Object(s["a"])(regeneratorRuntime.mark((function c(){var r,i;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:if(i=null===(r=t.value)||void 0===r?void 0:r.validate(),i){c.next=4;break}return Object(C["a"])({type:"warn",message:"请输入正确的数据"}),c.abrupt("return");case 4:if(a.value.isLogin||l.push("/login"),c.prev=5,!u.value){c.next=12;break}return c.next=9,Object(m["z"])(e.article_id,e.comment_id,{content:n.value});case 9:F.emit(T,e.comment_id),c.next=14;break;case 12:return c.next=14,Object(m["c"])(e.article_id,{content:n.value});case 14:n.value="",Object(C["a"])({type:"success",message:"评论成功"}),F.emit(L),c.next=21;break;case 19:c.prev=19,c.t0=c["catch"](5);case 21:case"end":return c.stop()}}),c,null,[[5,19]])})));return function(){return c.apply(this,arguments)}}(),f=function(){F.emit(T,e.comment_id)};return{commentRef:t,content:n,user:a,contentRules:o,publish:d,cancel:f,isReply:u}}});$.render=I;var G=$,V=Object(c["T"])("data-v-709659be");Object(c["A"])("data-v-709659be");var Y={key:0,class:"ps-3"},H=Object(c["l"])("i",{class:"bi bi-chevron-expand me-2"},null,-1);Object(c["y"])();var z=V((function(e,t,n,r,a,i){var o=Object(c["F"])("CommentCard"),u=Object(c["F"])("SubCommentList",!0),l=Object(c["F"])("List");return Object(c["x"])(),Object(c["i"])(c["a"],null,[Object(c["l"])(o,{comment:e.comment,isExpand:e.isExpand,onStarComment:e.starComment,onTriggerExpand:e.triggerExpand,class:"mb-2"},null,8,["comment","isExpand","onStarComment","onTriggerExpand"]),e.comment.children?(Object(c["x"])(),Object(c["i"])("div",Y,[e.isExpand?(Object(c["x"])(),Object(c["i"])(l,{key:1,class:"sub-comment-list"},{list:V((function(){return[(Object(c["x"])(!0),Object(c["i"])(c["a"],null,Object(c["D"])(e.comment.children,(function(e){return Object(c["x"])(),Object(c["i"])(u,{key:e._id,expand:!0,comment:e},null,8,["comment"])})),128))]})),_:1})):(Object(c["x"])(),Object(c["i"])("div",{key:0,class:"expand-bar ps-4 py-1 mb-3 text-muted fst-italic",onClick:t[1]||(t[1]=function(){return e.expandReplyComment&&e.expandReplyComment.apply(e,arguments)})},[H,Object(c["k"])(" 共 "+Object(c["J"])(e.comment.children.length)+" 条回复 ",1)]))])):Object(c["j"])("",!0)],64)})),Q={class:"me-3 d-flex flex-column align-items-center"},X={class:"border rounded-3 p-3 mb-2"},K={class:"comment-header d-flex justify-content-between mb-3"},W={class:"text-muted"},Z={class:"comment-content"},ee={class:"comment-actions mb-lg-3",ref:"actionsRef"},te={class:"mb-1"},ne={class:"text-muted"},ce=Object(c["l"])("i",{class:"bi bi-chat me-2"},null,-1),re=Object(c["k"])(" 回复 ");function ae(e,t,r,a,i,o){var u=Object(c["F"])("router-link"),l=Object(c["F"])("Card");return Object(c["x"])(),Object(c["i"])(l,{class:"comment-card flex-row"},{header:Object(c["P"])((function(){return[Object(c["l"])("div",Q,[Object(c["l"])(u,{to:"/profile/".concat(e.comment.commentator._id)},{default:Object(c["P"])((function(){return[Object(c["l"])("img",{src:e.comment.commentator.avatar_url||n("c121"),style:{width:"42px",height:"42px"},class:"rounded-circle border mb-2"},null,8,["src"])]})),_:1},8,["to"]),e.comment.children&&e.comment.children.length?(Object(c["x"])(),Object(c["i"])("i",{key:0,class:["bi expand-icon",e.isExpand?"bi-chevron-expand":"bi-chevron-contract"],onClick:t[1]||(t[1]=function(){return e.triggerExpand&&e.triggerExpand.apply(e,arguments)})},null,2)):Object(c["j"])("",!0)])]})),text:Object(c["P"])((function(){return[Object(c["l"])("div",X,[Object(c["l"])("div",K,[Object(c["l"])("div",W,[Object(c["l"])(u,{to:"/profile/".concat(e.comment.commentator._id),class:"text-decoration-none"},{default:Object(c["P"])((function(){return[Object(c["k"])(Object(c["J"])(e.comment.commentator.nickName),1)]})),_:1},8,["to"]),Object(c["k"])(" · "+Object(c["J"])(e.fromNow(e.comment.created_at)),1)])]),Object(c["l"])("div",Z,Object(c["J"])(e.comment.content),1)])]})),action:Object(c["P"])((function(){return[Object(c["l"])("div",ee,[Object(c["l"])("div",te,[Object(c["l"])("button",{type:"button",class:["btn-action",{starred:e.isStarred}],onClick:t[2]||(t[2]=function(t){return e.starComment(e.comment)})},[Object(c["l"])("i",{class:["bi me-2",e.isStarred?"bi-heart-fill":"bi-heart"]},null,2),Object(c["l"])("span",ne,Object(c["J"])(e.comment.thumb_count)+" 赞",1)],2),Object(c["l"])("button",{class:"btn-action",type:"button",onClick:t[3]||(t[3]=function(t){return e.replyComment(e.comment)})},[ce,re])])],512)]})),_:1})}n("caad"),n("2532");var ie=n("7a10"),oe=n("1842"),ue=Object(c["m"])({name:"CommentCard",components:{Card:x["a"]},emits:["star-comment","trigger-expand"],props:{comment:{type:Object,required:!0},isExpand:{type:Boolean,default:!0}},setup:function(e,t){var n=t.emit,r=Object(_["b"])(),a=Object(c["g"])((function(){return r.state.user})),i=Object(b["e"])(),o=Object(c["g"])((function(){return!!a.value.info&&a.value.info.starred_comments.includes(e.comment._id)})),u=Object(c["C"])(null),l=Object(c["C"])(null),s=Object(c["C"])(null),m=Object(ie["a"])(),d=m.fromNow,f=function(){n("trigger-expand")},j=function(e){n("star-comment",o.value,e)},O=function(e){u.value||(u.value=Object(c["h"])(G,{showAvatar:!1,article_id:e.article_id,comment_id:e._id}).use(oe["a"]).use(r).use(i),s.value=document.createElement("div"),l.value&&(l.value.appendChild(s.value),u.value.mount(s.value)))},p=function(t){var n,c;e.comment._id===t&&(null===(n=u.value)||void 0===n||n.unmount(),null===(c=s.value)||void 0===c||c.remove(),u.value=null)};return F.on(T,p),Object(c["w"])((function(){F.off(T,p)})),{actionsRef:l,isStarred:o,starComment:j,replyComment:O,triggerExpand:f,fromNow:d}}});n("3c34");ue.render=ae;var le=ue,se=Object(c["m"])({name:"SubCommentList",components:{List:U["a"],CommentCard:le},props:{expand:{type:Boolean,default:!0},comment:{type:Object,required:!0}},setup:function(e){var t=E(),n=t.starTheComment,r=Object(c["C"])(e.expand),a=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,c){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n(t,c);case 2:F.emit(L);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),i=function(){r.value=!r.value},o=function(){r.value=!r.value};return{isExpand:r,triggerExpand:i,expandReplyComment:o,starComment:a}}});n("5c2f");se.render=z,se.__scopeId="data-v-709659be";var be=se,me=Object(c["m"])({name:"CommentList",components:{List:U["a"],CommentEditor:G,SubCommentList:be},props:{article:{type:Object,required:!0},commentList:{type:Array,required:!0}}});me.render=P;var de=me,fe=Object(c["m"])({name:"ArticleDetail",components:{ArticleCard:d["a"],AuthorProfileCard:w,CommentList:de},setup:function(){var e=Object(b["d"])(),t=Object(c["C"])(e.params.id),n=Object(c["C"])(null),r=Object(c["C"])([]),a=Object(g["a"])(),i=a.followTheUser,o=E(),u=o.formatToTree,l=Object(f["a"])(),d=l.collectTheArticle,j=l.starTheArticle,O=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["e"])(t.value);case 2:c=e.sent,r=c.data,n.value=r;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var n,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["h"])(t.value);case 2:n=e.sent,c=n.data,r.value=u(c);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d(t,n);case 2:return e.next=4,O();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j(t,n);case 2:return e.next=4,O();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(){p()};return F.on(L,x),Object(c["w"])((function(){F.off(L,x)})),Object(c["v"])((function(){O(),p()})),Object(c["s"])((function(){t.value=e.params.id,O(),p()})),{id:t,article:n,commentList:r,collectArticle:v,starArticle:h,followTheUser:i}}});n("2381");fe.render=l,fe.__scopeId="data-v-5d4052c3";t["default"]=fe},"9d94":function(e,t,n){"use strict";n("e97a")},e01a:function(e,t,n){"use strict";var c=n("23e7"),r=n("83ab"),a=n("da84"),i=n("5135"),o=n("861d"),u=n("9bf2").f,l=n("e893"),s=a.Symbol;if(r&&"function"==typeof s&&(!("description"in s.prototype)||void 0!==s().description)){var b={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof m?new s(e):void 0===e?s():s(e);return""===e&&(b[t]=!0),t};l(m,s);var d=m.prototype=s.prototype;d.constructor=m;var f=d.toString,j="Symbol(test)"==String(s("test")),O=/^Symbol\((.*)\)[^)]+$/;u(d,"description",{configurable:!0,get:function(){var e=o(this)?this.valueOf():this,t=f.call(e);if(i(b,e))return"";var n=j?t.slice(7,-1):t.replace(O,"$1");return""===n?void 0:n}}),c({global:!0,forced:!0},{Symbol:m})}},e97a:function(e,t,n){}}]);
//# sourceMappingURL=chunk-d31accf4.83e01fe4.js.map