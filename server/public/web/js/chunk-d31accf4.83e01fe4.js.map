{"version":3,"sources":["webpack:///./src/views/Article/ArticleDetail.vue?ba65","webpack:///./src/hooks/useUser.ts","webpack:///./src/components/Card/CommentCard.vue?f0c6","webpack:///./src/components/List/SubCommentList.vue?6814","webpack:///./src/hooks/useRules.ts","webpack:///./src/components/List/index.vue","webpack:///./src/components/List/index.vue?52ec","webpack:///./src/components/List/index.vue?c9da","webpack:///./src/views/Article/ArticleDetail.vue","webpack:///./src/components/Card/AuthorProfileCard.vue","webpack:///./src/components/Card/AuthorProfileCard.vue?f88e","webpack:///./src/components/Card/AuthorProfileCard.vue?34e3","webpack:///./src/hooks/useComment.ts","webpack:///./node_modules/mitt/dist/mitt.es.js","webpack:///./src/libs/mitt.ts","webpack:///./src/config/constants.ts","webpack:///./src/components/List/CommentList.vue","webpack:///./src/components/Comment/CommentEditor.vue","webpack:///./src/components/Comment/CommentEditor.vue?fe8d","webpack:///./src/components/Comment/CommentEditor.vue?cc12","webpack:///./src/components/List/SubCommentList.vue","webpack:///./src/components/Card/CommentCard.vue","webpack:///./src/components/Card/CommentCard.vue?a6ca","webpack:///./src/components/Card/CommentCard.vue?0841","webpack:///./src/components/List/SubCommentList.vue?625c","webpack:///./src/components/List/SubCommentList.vue?bf12","webpack:///./src/components/List/CommentList.vue?f8da","webpack:///./src/components/List/CommentList.vue?e031","webpack:///./src/views/Article/ArticleDetail.vue?e7fc","webpack:///./src/views/Article/ArticleDetail.vue?9af9","webpack:///./src/components/Card/AuthorProfileCard.vue?e486","webpack:///./node_modules/core-js/modules/es.symbol.description.js"],"names":["useUser","id","router","store","user","state","isMe","value","info","_id","isFollowing","get","following","includes","set","newVal","followTheUser","author","isLogin","push","status","type","message","dispatch","FETCH_CURRENT_USER","useRules","nameRules","REQUIRED","passwordRules","againPwdRules","tagRules","RANGE","titleRules","contentRules","emailRules","EMAIL","searchRules","prefix","min","max","Number","MAX_SAFE_INTEGER","class","name","render","article","isDetail","collectArticle","starArticle","commentList","header","title","to","src","avatar_url","style","nickName","text","description","action","disabled","followUser","components","Card","props","Object","required","emits","setup","emit","__scopeId","starTheComment","isStarred","comment","formatToTree","data","filter","p","_children","c","reply_to","length","children","all","n","Map","on","t","e","i","off","splice","indexOf","slice","map","emitter","DESTROY_COMMENT_REPLY","UPDATE_AFTER_COMMENT_REPLY","comment_count","article_id","list","expand","showAvatar","ref","content","placeholder","rules","color","publish","isReply","cancel","Boolean","default","String","comment_id","commentRef","result","validate","isExpand","starComment","triggerExpand","expandReplyComment","commentator","fromNow","created_at","thumb_count","replyComment","starred_comments","editor_instance","actionsRef","mountEle","useDayjs","CommentEditor","use","V","document","createElement","appendChild","mount","callback","unmount","remove","List","CommentCard","SubCommentList","Array","ArticleCard","AuthorProfileCard","CommentList","route","params","useArticle","collectTheArticle","starTheArticle","getArticle","getComments","isCollected","$","DESCRIPTORS","global","has","isObject","defineProperty","f","copyConstructorProperties","NativeSymbol","Symbol","prototype","undefined","EmptyStringDescriptionStore","SymbolWrapper","arguments","this","symbolPrototype","constructor","symbolToString","toString","native","regexp","configurable","symbol","valueOf","string","call","desc","replace","forced"],"mappings":"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","file":"js/chunk-d31accf4.83e01fe4.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ArticleDetail.vue?vue&type=style&index=0&id=5d4052c3&lang=scss&scoped=true\"","import { followUser, unFollowUser } from \"@/api\";\nimport $message from \"@/components/Message\";\nimport { ATS } from \"@/store/actionTypes\";\nimport { IState, IUser, IUserState } from \"@/typings\";\nimport { computed, ComputedRef, Ref, watch, WritableComputedRef } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { useStore } from \"vuex\";\n\ntype IUseUser = (\n  user_id?: Ref<string> | undefined\n) => {\n  user: ComputedRef<IUserState>;\n  isMe: ComputedRef<boolean>;\n  isFollowing: WritableComputedRef<boolean>;\n  followTheUser: (isFollowing: boolean, author: IUser) => void;\n};\n\nconst useUser: IUseUser = (id: Ref<string> | undefined) => {\n  const router = useRouter();\n  const store = useStore<IState>();\n  const user = computed(() => store.state.user);\n  const isMe = computed(() => user.value.info?._id === id?.value);\n\n  const isFollowing = computed({\n    get: () => {\n      if (user.value.info) {\n        return user.value.info.following.includes(id ? id.value : \"\");\n      } else {\n        return false;\n      }\n    },\n    set: (newVal) => {\n      return newVal;\n    },\n  });\n\n  if (id) {\n    watch(id, (newVal) => {\n      if (user.value.info) {\n        isFollowing.value = user.value.info.following.includes(newVal);\n      } else {\n        isFollowing.value = false;\n      }\n    });\n  }\n\n  const followTheUser = async (isFollowing: boolean, author: IUser) => {\n    if (!user.value.isLogin) {\n      router.push(\"/login\");\n      return;\n    }\n\n    try {\n      if (isFollowing) {\n        // unFollow\n        const { status } = await unFollowUser(author._id);\n        if (status === 204) {\n          $message({\n            type: \"success\",\n            message: \"取消关注成功\",\n          });\n        }\n      } else {\n        // follow\n        const { status } = await followUser(author._id);\n        if (status === 204) {\n          $message({\n            type: \"success\",\n            message: \"关注成功\",\n          });\n        }\n      }\n      store.dispatch(ATS.FETCH_CURRENT_USER);\n    } catch (error) {\n      //\n    }\n  };\n\n  return {\n    user,\n    isMe,\n    isFollowing,\n    followTheUser,\n  };\n};\n\nexport default useUser;\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CommentCard.vue?vue&type=style&index=0&id=814989f4&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SubCommentList.vue?vue&type=style&index=0&id=709659be&lang=scss&scoped=true\"","import { IRule, RULE_TYPE } from \"@/typings\";\n\n/**\n * 表单输入校验规则\n */\n\nconst useRules = () => {\n  const nameRules = [REQUIRED(\"用户名\")];\n  const passwordRules = [REQUIRED(\"密码\")];\n  const againPwdRules = [REQUIRED(\"密码\")];\n  const tagRules = [REQUIRED(\"标签\"), RANGE(1, 4)];\n  const titleRules = [REQUIRED(\"标题\")];\n  const contentRules = [REQUIRED(\"文章内容\")];\n  const emailRules = [\n    REQUIRED(\"邮箱\"),\n    { type: RULE_TYPE.EMAIL, message: \"请输入合法的邮箱\" },\n  ];\n  const searchRules = [REQUIRED(\"搜索内容\")];\n\n  function REQUIRED(prefix: string): IRule {\n    return {\n      type: RULE_TYPE.REQUIRED,\n      message: `${prefix}不能为空`,\n    };\n  }\n\n  function RANGE(min = 0, max = Number.MAX_SAFE_INTEGER): IRule {\n    return {\n      type: RULE_TYPE.RANGE,\n      message: `数量/长度只能在${min}-${max}`,\n      min,\n      max,\n    };\n  }\n\n  return {\n    nameRules,\n    passwordRules,\n    againPwdRules,\n    tagRules,\n    titleRules,\n    contentRules,\n    emailRules,\n    searchRules,\n  };\n};\n\nexport default useRules;\n","<template>\n  <div class=\"list\">\n    <slot name=\"header\"></slot>\n    <div class=\"list-body\">\n      <slot name=\"list\"></slot>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"List\",\n});\n</script>\n\n<style lang=\"scss\" scoped></style>\n","\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"List\",\n});\n","import { render } from \"./index.vue?vue&type=template&id=31f1a623\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"container article-detail-page py-3\">\n    <div class=\"row\">\n      <div class=\"offset-lg-1 col-lg-8 offset-md-1 col-md-11 col-12\">\n        <ArticleCard\n          v-if=\"article\"\n          :article=\"article\"\n          :isDetail=\"true\"\n          @collect-article=\"collectArticle\"\n          @star-article=\"starArticle\"\n        />\n\n        <CommentList\n          v-if=\"article\"\n          class=\"comment-area bg-white p-lg-5 p-3\"\n          :article=\"article\"\n          :commentList=\"commentList\"\n        />\n      </div>\n\n      <div\n        class=\"col-lg-3 col-md-12 col-sm-12 d-none d-md-block mt-md-3 mt-lg-0\"\n      >\n        <AuthorProfileCard\n          v-if=\"article\"\n          :author=\"article.author\"\n          class=\"mb-3\"\n          @follow-user=\"followTheUser\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { useRoute } from \"vue-router\";\nimport { defineComponent, onActivated, onMounted, onUnmounted, ref } from \"vue\";\nimport { IArticle, IComment } from \"@/typings\";\nimport { fetchArticle, fetchCommentsByArticleId } from \"@/api\";\nimport ArticleCard from \"@/components/Card/ArticleCard.vue\";\nimport useArticle from \"@/hooks/useArticle\";\nimport AuthorProfileCard from \"@/components/Card/AuthorProfileCard.vue\";\nimport useUser from \"@/hooks/useUser\";\nimport useComment from \"@/hooks/useComment\";\nimport { emitter } from \"@/libs/mitt\";\nimport { UPDATE_AFTER_COMMENT_REPLY } from \"@/config/constants\";\nimport CommentList from \"@/components/List/CommentList.vue\";\n\nexport default defineComponent({\n  name: \"ArticleDetail\",\n  components: {\n    ArticleCard,\n    AuthorProfileCard,\n    CommentList,\n  },\n  setup() {\n    const route = useRoute();\n    const id = ref(route.params.id as string);\n    const article = ref<IArticle | null>(null);\n    const commentList = ref<IComment[]>([]);\n\n    const { followTheUser } = useUser();\n    const { formatToTree } = useComment();\n    const { collectTheArticle, starTheArticle } = useArticle();\n\n    const getArticle = async () => {\n      const { data } = await fetchArticle(id.value);\n      article.value = data;\n    };\n\n    const getComments = async () => {\n      const { data } = await fetchCommentsByArticleId(id.value);\n      commentList.value = formatToTree(data);\n    };\n\n    const collectArticle = async (isCollected: boolean, article: IArticle) => {\n      await collectTheArticle(isCollected, article);\n      await getArticle();\n    };\n\n    const starArticle = async (isStarred: boolean, article: IArticle) => {\n      await starTheArticle(isStarred, article);\n      await getArticle();\n    };\n\n    const callback = () => {\n      getComments();\n    };\n    emitter.on(UPDATE_AFTER_COMMENT_REPLY, callback);\n\n    onUnmounted(() => {\n      emitter.off(UPDATE_AFTER_COMMENT_REPLY, callback);\n    });\n\n    onMounted(() => {\n      getArticle();\n      getComments();\n    });\n\n    onActivated(() => {\n      id.value = route.params.id as string;\n      getArticle();\n      getComments();\n    });\n\n    return {\n      id,\n      article,\n      commentList,\n      collectArticle,\n      starArticle,\n      followTheUser,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.article-detail-page {\n  .comment-area {\n    border: 2px solid rgba(0, 0, 0, 0.125);\n    border-top: none;\n    border-radius: 0 0 $bd-radius-sm $bd-radius-sm;\n  }\n}\n</style>\n","<template>\n  <Card class=\"author-profile-card\">\n    <template v-slot:header> </template>\n\n    <template v-slot:title>\n      <div class=\"card-title d-flex\">\n        <router-link :to=\"`/profile/${author._id}`\">\n          <img\n            :src=\"author.avatar_url || require('@/assets/user.png')\"\n            style=\"width: 50px\"\n            class=\"rounded-circle me-3\"\n          />\n        </router-link>\n        <h4 class=\"card-text align-self-end\">\n          <router-link\n            class=\"text-decoration-none text-dark fw-bold\"\n            :to=\"`/profile/${author._id}`\"\n            >{{ author.nickName }}</router-link\n          >\n        </h4>\n      </div>\n    </template>\n\n    <template v-slot:text>\n      <p class=\"card-text\">{{ author.description }}</p>\n    </template>\n\n    <template v-slot:action>\n      <button\n        type=\"button\"\n        :disabled=\"author._id === (user.info && user.info._id)\"\n        :class=\"[\n          'btn w-100 py-2',\n          isFollowing ? 'btn-primary' : 'btn-outline-primary',\n        ]\"\n        @click=\"followUser(author)\"\n      >\n        {{ isFollowing ? \"已关注\" : \"关注\" }}\n      </button>\n    </template>\n  </Card>\n</template>\n\n<script lang=\"ts\">\nimport { IUser } from \"@/typings\";\nimport { defineComponent, PropType, ref, watch } from \"vue\";\nimport Card from \"./index.vue\";\nimport useUser from \"@/hooks/useUser\";\n\nexport default defineComponent({\n  name: \"AuthorProfileCard\",\n  components: {\n    Card,\n  },\n  props: {\n    author: {\n      type: Object as PropType<IUser>,\n      required: true,\n    },\n  },\n  emits: [\"follow-user\"],\n  setup(props, { emit }) {\n    const id = ref(props.author._id);\n    const { user, isFollowing } = useUser(id);\n\n    const followUser = (user: IUser) => {\n      emit(\"follow-user\", isFollowing.value, user);\n    };\n\n    watch(\n      () => props.author,\n      (newVal) => {\n        id.value = newVal._id;\n      }\n    );\n\n    return {\n      user,\n      isFollowing,\n      followUser,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.author-profile-card {\n  border-top-width: 32px;\n  border-top-color: $blue-600;\n\n  .card-title {\n    margin-top: -32px;\n  }\n}\n</style>\n","\nimport { IUser } from \"@/typings\";\nimport { defineComponent, PropType, ref, watch } from \"vue\";\nimport Card from \"./index.vue\";\nimport useUser from \"@/hooks/useUser\";\n\nexport default defineComponent({\n  name: \"AuthorProfileCard\",\n  components: {\n    Card,\n  },\n  props: {\n    author: {\n      type: Object as PropType<IUser>,\n      required: true,\n    },\n  },\n  emits: [\"follow-user\"],\n  setup(props, { emit }) {\n    const id = ref(props.author._id);\n    const { user, isFollowing } = useUser(id);\n\n    const followUser = (user: IUser) => {\n      emit(\"follow-user\", isFollowing.value, user);\n    };\n\n    watch(\n      () => props.author,\n      (newVal) => {\n        id.value = newVal._id;\n      }\n    );\n\n    return {\n      user,\n      isFollowing,\n      followUser,\n    };\n  },\n});\n","import { render } from \"./AuthorProfileCard.vue?vue&type=template&id=2aaafe12&scoped=true\"\nimport script from \"./AuthorProfileCard.vue?vue&type=script&lang=ts\"\nexport * from \"./AuthorProfileCard.vue?vue&type=script&lang=ts\"\n\nimport \"./AuthorProfileCard.vue?vue&type=style&index=0&id=2aaafe12&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-2aaafe12\"\n\nexport default script","import { IComment, IState } from \"@/typings\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\nimport { computed } from \"vue\";\nimport { starComment, unStarComment } from \"@/api\";\nimport $message from \"@/components/Message\";\nimport { ATS } from \"@/store/actionTypes\";\n\ntype IUseComment = () => {\n  starTheComment: (isStarred: boolean, comment: IComment) => void;\n  formatToTree: (data: IComment[]) => IComment[];\n};\n\nconst useComment: IUseComment = () => {\n  const router = useRouter();\n  const store = useStore<IState>();\n  const user = computed(() => store.state.user);\n\n  const starTheComment = async (isStarred: boolean, comment: IComment) => {\n    if (!user.value.isLogin) {\n      router.push(\"/login\");\n      return;\n    }\n\n    try {\n      if (isStarred) {\n        // unStar\n        const { status } = await unStarComment(comment._id);\n        if (status === 204) {\n          $message({\n            type: \"success\",\n            message: \"取消点赞成功\",\n          });\n        }\n      } else {\n        // star\n        const { status } = await starComment(comment._id);\n        if (status === 204) {\n          $message({\n            type: \"success\",\n            message: \"点赞成功\",\n          });\n        }\n      }\n      store.dispatch(ATS.FETCH_CURRENT_USER);\n    } catch (error) {\n      //\n    }\n  };\n\n  /**\n   * 评论 - 扁平化 -> tree\n   */\n\n  function formatToTree(data: IComment[] = []): IComment[] {\n    return data.filter((p) => {\n      const _children = data.filter((c) => c.reply_to?._id === p._id);\n      _children.length && (p.children = _children);\n\n      return p.reply_to === null;\n    });\n  }\n\n  return {\n    starTheComment,\n    formatToTree,\n  };\n};\n\nexport default useComment;\n","export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i&&i.push(e)||n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&i.splice(i.indexOf(e)>>>0,1)},emit:function(t,e){(n.get(t)||[]).slice().map(function(n){n(e)}),(n.get(\"*\")||[]).slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.es.js.map\n","import mitt from \"mitt\";\n\nconst emitter = mitt();\n\nexport { emitter };\n","export const FORM_ITEM_MOUNTED = \"FORM_ITEM_MOUNTED\";\nexport const DESTROY_COMMENT_REPLY = \"DESTROY_COMMENT_REPLY\";\nexport const UPDATE_AFTER_COMMENT_REPLY = \"UPDATE_AFTER_COMMENT_REPLY\";\n","<template>\n  <List class=\"comment-list\">\n    <template v-slot:header>\n      <p class=\"fs-4 fw-bold\">评论（{{ article.comment_count }}）</p>\n      <CommentEditor :article_id=\"article._id\" class=\"mb-lg-5 mb-3\" />\n    </template>\n\n    <template v-slot:list>\n      <template v-for=\"comment of commentList\" :key=\"comment._id\">\n        <SubCommentList :expand=\"true\" :comment=\"comment\" />\n      </template>\n    </template>\n  </List>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from \"vue\";\nimport List from \"./index.vue\";\nimport CommentEditor from \"@/components/Comment/CommentEditor.vue\";\nimport { IArticle, IComment } from \"@/typings\";\nimport SubCommentList from \"./SubCommentList.vue\";\n\nexport default defineComponent({\n  name: \"CommentList\",\n  components: {\n    List,\n    CommentEditor,\n    SubCommentList,\n  },\n  props: {\n    article: {\n      type: Object as PropType<IArticle>,\n      required: true,\n    },\n    commentList: {\n      type: Array as PropType<IComment[]>,\n      required: true,\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped></style>\n","<template>\n  <div class=\"comment-editor d-flex\">\n    <div v-if=\"showAvatar\" class=\"me-3\">\n      <img\n        :src=\"\n          (user.info && user.info.avatar_url) || require('@/assets/user.png')\n        \"\n        style=\"width: 42px; height: 42px\"\n        class=\"rounded-circle border\"\n      />\n    </div>\n    <v-form class=\"w-100\" ref=\"commentRef\">\n      <v-textarea\n        v-model=\"content\"\n        placeholder=\"添加评论\"\n        :rules=\"contentRules\"\n      />\n\n      <div class=\"mt-3\">\n        <v-btn color=\"primary \" @click=\"publish\"> 发表评论 </v-btn>\n        <v-btn color=\"secondary ms-3\" v-if=\"isReply\" @click=\"cancel\">\n          取消\n        </v-btn>\n      </div>\n    </v-form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, ref } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { IState } from \"@/typings\";\nimport useRules from \"@/hooks/useRules\";\nimport $message from \"../Message\";\nimport { createArticleComment, replyComment } from \"@/api\";\nimport { emitter } from \"@/libs/mitt\";\nimport {\n  DESTROY_COMMENT_REPLY,\n  UPDATE_AFTER_COMMENT_REPLY,\n} from \"@/config/constants\";\nimport { useRouter } from \"vue-router\";\n\nexport default defineComponent({\n  name: \"CommentEditor\",\n  props: {\n    showAvatar: {\n      type: Boolean,\n      default: true,\n    },\n    article_id: {\n      type: String,\n      required: true,\n    },\n    comment_id: {\n      type: String,\n      default: \"\",\n    },\n  },\n  emits: [\"publish-success\"],\n  setup(props) {\n    const commentRef = ref<null | HTMLFormElement>(null);\n    const content = ref(\"\");\n    const store = useStore<IState>();\n    const user = computed(() => store.state.user);\n    const { contentRules } = useRules();\n    const isReply = ref(props.comment_id ? true : false);\n    const router = useRouter();\n\n    const publish = async () => {\n      const result = commentRef.value?.validate();\n      if (!result) {\n        $message({\n          type: \"warn\",\n          message: \"请输入正确的数据\",\n        });\n        return;\n      }\n\n      if (!user.value.isLogin) {\n        router.push(\"/login\");\n      }\n\n      try {\n        if (isReply.value) {\n          await replyComment(props.article_id, props.comment_id, {\n            content: content.value,\n          });\n          emitter.emit(DESTROY_COMMENT_REPLY, props.comment_id);\n        } else {\n          await createArticleComment(props.article_id, {\n            content: content.value,\n          });\n        }\n        content.value = \"\";\n        $message({\n          type: \"success\",\n          message: \"评论成功\",\n        });\n        emitter.emit(UPDATE_AFTER_COMMENT_REPLY);\n      } catch (error) {\n        //\n      }\n    };\n\n    const cancel = () => {\n      emitter.emit(DESTROY_COMMENT_REPLY, props.comment_id);\n    };\n\n    return {\n      commentRef,\n      content,\n      user,\n      contentRules,\n      publish,\n      cancel,\n      isReply,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped></style>\n","\nimport { computed, defineComponent, ref } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { IState } from \"@/typings\";\nimport useRules from \"@/hooks/useRules\";\nimport $message from \"../Message\";\nimport { createArticleComment, replyComment } from \"@/api\";\nimport { emitter } from \"@/libs/mitt\";\nimport {\n  DESTROY_COMMENT_REPLY,\n  UPDATE_AFTER_COMMENT_REPLY,\n} from \"@/config/constants\";\nimport { useRouter } from \"vue-router\";\n\nexport default defineComponent({\n  name: \"CommentEditor\",\n  props: {\n    showAvatar: {\n      type: Boolean,\n      default: true,\n    },\n    article_id: {\n      type: String,\n      required: true,\n    },\n    comment_id: {\n      type: String,\n      default: \"\",\n    },\n  },\n  emits: [\"publish-success\"],\n  setup(props) {\n    const commentRef = ref<null | HTMLFormElement>(null);\n    const content = ref(\"\");\n    const store = useStore<IState>();\n    const user = computed(() => store.state.user);\n    const { contentRules } = useRules();\n    const isReply = ref(props.comment_id ? true : false);\n    const router = useRouter();\n\n    const publish = async () => {\n      const result = commentRef.value?.validate();\n      if (!result) {\n        $message({\n          type: \"warn\",\n          message: \"请输入正确的数据\",\n        });\n        return;\n      }\n\n      if (!user.value.isLogin) {\n        router.push(\"/login\");\n      }\n\n      try {\n        if (isReply.value) {\n          await replyComment(props.article_id, props.comment_id, {\n            content: content.value,\n          });\n          emitter.emit(DESTROY_COMMENT_REPLY, props.comment_id);\n        } else {\n          await createArticleComment(props.article_id, {\n            content: content.value,\n          });\n        }\n        content.value = \"\";\n        $message({\n          type: \"success\",\n          message: \"评论成功\",\n        });\n        emitter.emit(UPDATE_AFTER_COMMENT_REPLY);\n      } catch (error) {\n        //\n      }\n    };\n\n    const cancel = () => {\n      emitter.emit(DESTROY_COMMENT_REPLY, props.comment_id);\n    };\n\n    return {\n      commentRef,\n      content,\n      user,\n      contentRules,\n      publish,\n      cancel,\n      isReply,\n    };\n  },\n});\n","import { render } from \"./CommentEditor.vue?vue&type=template&id=736c90bb\"\nimport script from \"./CommentEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./CommentEditor.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <CommentCard\n    :comment=\"comment\"\n    :isExpand=\"isExpand\"\n    @star-comment=\"starComment\"\n    @trigger-expand=\"triggerExpand\"\n    class=\"mb-2\"\n  />\n  <div class=\"ps-3\" v-if=\"comment.children\">\n    <div\n      v-if=\"!isExpand\"\n      class=\"expand-bar ps-4 py-1 mb-3 text-muted fst-italic\"\n      @click=\"expandReplyComment\"\n    >\n      <i class=\"bi bi-chevron-expand me-2\"></i>\n      共 {{ comment.children.length }} 条回复\n    </div>\n    <List class=\"sub-comment-list\" v-else>\n      <template v-slot:list>\n        <template v-for=\"comment of comment.children\" :key=\"comment._id\">\n          <SubCommentList :expand=\"true\" :comment=\"comment\" />\n        </template>\n      </template>\n    </List>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { UPDATE_AFTER_COMMENT_REPLY } from \"@/config/constants\";\nimport useComment from \"@/hooks/useComment\";\nimport { emitter } from \"@/libs/mitt\";\nimport { IComment } from \"@/typings\";\nimport { defineComponent, PropType, ref } from \"vue\";\nimport List from \"@/components/List/index.vue\";\nimport CommentCard from \"@/components/Card/CommentCard.vue\";\n\nexport default defineComponent({\n  name: \"SubCommentList\",\n  components: {\n    List,\n    CommentCard,\n  },\n  props: {\n    expand: {\n      type: Boolean,\n      default: true,\n    },\n    comment: {\n      type: Object as PropType<IComment>,\n      required: true,\n    },\n  },\n  setup(props) {\n    const { starTheComment } = useComment();\n    const isExpand = ref(props.expand);\n\n    const starComment = async (isStarred: boolean, comment: IComment) => {\n      await starTheComment(isStarred, comment);\n      emitter.emit(UPDATE_AFTER_COMMENT_REPLY);\n    };\n\n    const triggerExpand = () => {\n      isExpand.value = !isExpand.value;\n    };\n\n    const expandReplyComment = () => {\n      isExpand.value = !isExpand.value;\n    };\n\n    return {\n      isExpand,\n      triggerExpand,\n      expandReplyComment,\n      starComment,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.expand-bar {\n  background: $gray-200;\n  border-radius: $bd-radius-sm;\n\n  &:hover {\n    cursor: pointer;\n  }\n}\n</style>\n","<template>\n  <Card class=\"comment-card flex-row\">\n    <template v-slot:header>\n      <div class=\"me-3 d-flex flex-column align-items-center\">\n        <router-link :to=\"`/profile/${comment.commentator._id}`\">\n          <img\n            :src=\"\n              comment.commentator.avatar_url || require('@/assets/user.png')\n            \"\n            style=\"width: 42px; height: 42px\"\n            class=\"rounded-circle border mb-2\"\n          />\n        </router-link>\n        <i\n          v-if=\"comment.children && comment.children.length\"\n          :class=\"[\n            'bi expand-icon',\n            isExpand ? 'bi-chevron-expand' : 'bi-chevron-contract',\n          ]\"\n          @click=\"triggerExpand\"\n        ></i>\n      </div>\n    </template>\n\n    <template v-slot:text>\n      <div class=\"border rounded-3 p-3 mb-2\">\n        <div class=\"comment-header d-flex justify-content-between mb-3\">\n          <div class=\"text-muted\">\n            <router-link\n              :to=\"`/profile/${comment.commentator._id}`\"\n              class=\"text-decoration-none\"\n            >\n              {{ comment.commentator.nickName }}\n            </router-link>\n            ·\n            {{ fromNow(comment.created_at) }}\n          </div>\n          <!-- TODO: 评论编辑，删除\n          <div class=\"comment-operations\">\n            <i class=\"bi bi-three-dots\"></i>\n          </div> -->\n        </div>\n        <div class=\"comment-content\">\n          {{ comment.content }}\n        </div>\n      </div>\n    </template>\n\n    <template v-slot:action>\n      <div class=\"comment-actions mb-lg-3\" ref=\"actionsRef\">\n        <div class=\"mb-1\">\n          <button\n            type=\"button\"\n            :class=\"['btn-action', { starred: isStarred }]\"\n            @click=\"starComment(comment)\"\n          >\n            <i\n              :class=\"['bi me-2', isStarred ? 'bi-heart-fill' : 'bi-heart']\"\n            ></i>\n            <span class=\"text-muted\">{{ comment.thumb_count }} 赞</span>\n          </button>\n          <button\n            class=\"btn-action\"\n            type=\"button\"\n            @click=\"replyComment(comment)\"\n          >\n            <i class=\"bi bi-chat me-2\"></i>\n            回复\n          </button>\n        </div>\n      </div>\n    </template>\n  </Card>\n</template>\n\n<script lang=\"ts\">\nimport { IComment, IState } from \"@/typings\";\nimport {\n  App,\n  computed,\n  createApp,\n  defineComponent,\n  onUnmounted,\n  PropType,\n  ref,\n} from \"vue\";\nimport Card from \"./index.vue\";\nimport { useStore } from \"vuex\";\nimport CommentEditor from \"@/components/Comment/CommentEditor.vue\";\nimport { emitter } from \"@/libs/mitt\";\nimport { DESTROY_COMMENT_REPLY } from \"@/config/constants\";\nimport useDayjs from \"@/hooks/useDayjs\";\nimport { useRouter } from \"vue-router\";\nimport V from \"@/libs/V\";\n\nexport default defineComponent({\n  name: \"CommentCard\",\n  components: {\n    Card,\n  },\n  emits: [\"star-comment\", \"trigger-expand\"],\n  props: {\n    comment: {\n      type: Object as PropType<IComment>,\n      required: true,\n    },\n    isExpand: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  setup(props, { emit }) {\n    const store = useStore<IState>();\n    const user = computed(() => store.state.user);\n    const router = useRouter();\n    const isStarred = computed(() => {\n      if (user.value.info) {\n        return user.value.info.starred_comments.includes(props.comment._id);\n      } else {\n        return false;\n      }\n    });\n\n    const editor_instance = ref<null | App>(null);\n    const actionsRef = ref<null | HTMLElement>(null);\n    const mountEle = ref<null | HTMLDivElement>(null);\n\n    const { fromNow } = useDayjs();\n\n    const triggerExpand = () => {\n      emit(\"trigger-expand\");\n    };\n\n    const starComment = (comment: IComment) => {\n      emit(\"star-comment\", isStarred.value, comment);\n    };\n\n    const replyComment = (comment: IComment) => {\n      if (editor_instance.value) return;\n\n      editor_instance.value = createApp(CommentEditor, {\n        showAvatar: false,\n        article_id: comment.article_id,\n        comment_id: comment._id,\n      })\n        .use(V)\n        .use(store)\n        .use(router);\n\n      mountEle.value = document.createElement(\"div\");\n      if (actionsRef.value) {\n        actionsRef.value.appendChild(mountEle.value);\n        editor_instance.value.mount(mountEle.value);\n      }\n    };\n\n    const callback = (id: string | undefined) => {\n      if (props.comment._id === id) {\n        editor_instance.value?.unmount();\n        mountEle.value?.remove();\n        editor_instance.value = null;\n      }\n    };\n\n    emitter.on(DESTROY_COMMENT_REPLY, callback);\n\n    onUnmounted(() => {\n      emitter.off(DESTROY_COMMENT_REPLY, callback);\n    });\n\n    return {\n      actionsRef,\n      isStarred,\n      starComment,\n      replyComment,\n      triggerExpand,\n      fromNow,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\">\n.comment-card {\n  border: none;\n\n  .expand-icon {\n    color: $gray-500;\n\n    &:hover {\n      cursor: pointer;\n      color: $black;\n    }\n  }\n\n  .card-body {\n    padding: 0;\n  }\n\n  .btn-action {\n    outline: none;\n    border: none;\n    background-color: $white;\n    padding: 4px 10px;\n    border-radius: $bd-radius-sm;\n    margin-right: 8px;\n\n    &:hover {\n      background-color: $gray-200;\n    }\n\n    &.starred {\n      color: $red;\n    }\n  }\n}\n</style>\n","\nimport { IComment, IState } from \"@/typings\";\nimport {\n  App,\n  computed,\n  createApp,\n  defineComponent,\n  onUnmounted,\n  PropType,\n  ref,\n} from \"vue\";\nimport Card from \"./index.vue\";\nimport { useStore } from \"vuex\";\nimport CommentEditor from \"@/components/Comment/CommentEditor.vue\";\nimport { emitter } from \"@/libs/mitt\";\nimport { DESTROY_COMMENT_REPLY } from \"@/config/constants\";\nimport useDayjs from \"@/hooks/useDayjs\";\nimport { useRouter } from \"vue-router\";\nimport V from \"@/libs/V\";\n\nexport default defineComponent({\n  name: \"CommentCard\",\n  components: {\n    Card,\n  },\n  emits: [\"star-comment\", \"trigger-expand\"],\n  props: {\n    comment: {\n      type: Object as PropType<IComment>,\n      required: true,\n    },\n    isExpand: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  setup(props, { emit }) {\n    const store = useStore<IState>();\n    const user = computed(() => store.state.user);\n    const router = useRouter();\n    const isStarred = computed(() => {\n      if (user.value.info) {\n        return user.value.info.starred_comments.includes(props.comment._id);\n      } else {\n        return false;\n      }\n    });\n\n    const editor_instance = ref<null | App>(null);\n    const actionsRef = ref<null | HTMLElement>(null);\n    const mountEle = ref<null | HTMLDivElement>(null);\n\n    const { fromNow } = useDayjs();\n\n    const triggerExpand = () => {\n      emit(\"trigger-expand\");\n    };\n\n    const starComment = (comment: IComment) => {\n      emit(\"star-comment\", isStarred.value, comment);\n    };\n\n    const replyComment = (comment: IComment) => {\n      if (editor_instance.value) return;\n\n      editor_instance.value = createApp(CommentEditor, {\n        showAvatar: false,\n        article_id: comment.article_id,\n        comment_id: comment._id,\n      })\n        .use(V)\n        .use(store)\n        .use(router);\n\n      mountEle.value = document.createElement(\"div\");\n      if (actionsRef.value) {\n        actionsRef.value.appendChild(mountEle.value);\n        editor_instance.value.mount(mountEle.value);\n      }\n    };\n\n    const callback = (id: string | undefined) => {\n      if (props.comment._id === id) {\n        editor_instance.value?.unmount();\n        mountEle.value?.remove();\n        editor_instance.value = null;\n      }\n    };\n\n    emitter.on(DESTROY_COMMENT_REPLY, callback);\n\n    onUnmounted(() => {\n      emitter.off(DESTROY_COMMENT_REPLY, callback);\n    });\n\n    return {\n      actionsRef,\n      isStarred,\n      starComment,\n      replyComment,\n      triggerExpand,\n      fromNow,\n    };\n  },\n});\n","import { render } from \"./CommentCard.vue?vue&type=template&id=814989f4\"\nimport script from \"./CommentCard.vue?vue&type=script&lang=ts\"\nexport * from \"./CommentCard.vue?vue&type=script&lang=ts\"\n\nimport \"./CommentCard.vue?vue&type=style&index=0&id=814989f4&lang=scss\"\nscript.render = render\n\nexport default script","\nimport { UPDATE_AFTER_COMMENT_REPLY } from \"@/config/constants\";\nimport useComment from \"@/hooks/useComment\";\nimport { emitter } from \"@/libs/mitt\";\nimport { IComment } from \"@/typings\";\nimport { defineComponent, PropType, ref } from \"vue\";\nimport List from \"@/components/List/index.vue\";\nimport CommentCard from \"@/components/Card/CommentCard.vue\";\n\nexport default defineComponent({\n  name: \"SubCommentList\",\n  components: {\n    List,\n    CommentCard,\n  },\n  props: {\n    expand: {\n      type: Boolean,\n      default: true,\n    },\n    comment: {\n      type: Object as PropType<IComment>,\n      required: true,\n    },\n  },\n  setup(props) {\n    const { starTheComment } = useComment();\n    const isExpand = ref(props.expand);\n\n    const starComment = async (isStarred: boolean, comment: IComment) => {\n      await starTheComment(isStarred, comment);\n      emitter.emit(UPDATE_AFTER_COMMENT_REPLY);\n    };\n\n    const triggerExpand = () => {\n      isExpand.value = !isExpand.value;\n    };\n\n    const expandReplyComment = () => {\n      isExpand.value = !isExpand.value;\n    };\n\n    return {\n      isExpand,\n      triggerExpand,\n      expandReplyComment,\n      starComment,\n    };\n  },\n});\n","import { render } from \"./SubCommentList.vue?vue&type=template&id=709659be&scoped=true\"\nimport script from \"./SubCommentList.vue?vue&type=script&lang=ts\"\nexport * from \"./SubCommentList.vue?vue&type=script&lang=ts\"\n\nimport \"./SubCommentList.vue?vue&type=style&index=0&id=709659be&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-709659be\"\n\nexport default script","\nimport { defineComponent, PropType } from \"vue\";\nimport List from \"./index.vue\";\nimport CommentEditor from \"@/components/Comment/CommentEditor.vue\";\nimport { IArticle, IComment } from \"@/typings\";\nimport SubCommentList from \"./SubCommentList.vue\";\n\nexport default defineComponent({\n  name: \"CommentList\",\n  components: {\n    List,\n    CommentEditor,\n    SubCommentList,\n  },\n  props: {\n    article: {\n      type: Object as PropType<IArticle>,\n      required: true,\n    },\n    commentList: {\n      type: Array as PropType<IComment[]>,\n      required: true,\n    },\n  },\n});\n","import { render } from \"./CommentList.vue?vue&type=template&id=f9d09cb8\"\nimport script from \"./CommentList.vue?vue&type=script&lang=ts\"\nexport * from \"./CommentList.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport { useRoute } from \"vue-router\";\nimport { defineComponent, onActivated, onMounted, onUnmounted, ref } from \"vue\";\nimport { IArticle, IComment } from \"@/typings\";\nimport { fetchArticle, fetchCommentsByArticleId } from \"@/api\";\nimport ArticleCard from \"@/components/Card/ArticleCard.vue\";\nimport useArticle from \"@/hooks/useArticle\";\nimport AuthorProfileCard from \"@/components/Card/AuthorProfileCard.vue\";\nimport useUser from \"@/hooks/useUser\";\nimport useComment from \"@/hooks/useComment\";\nimport { emitter } from \"@/libs/mitt\";\nimport { UPDATE_AFTER_COMMENT_REPLY } from \"@/config/constants\";\nimport CommentList from \"@/components/List/CommentList.vue\";\n\nexport default defineComponent({\n  name: \"ArticleDetail\",\n  components: {\n    ArticleCard,\n    AuthorProfileCard,\n    CommentList,\n  },\n  setup() {\n    const route = useRoute();\n    const id = ref(route.params.id as string);\n    const article = ref<IArticle | null>(null);\n    const commentList = ref<IComment[]>([]);\n\n    const { followTheUser } = useUser();\n    const { formatToTree } = useComment();\n    const { collectTheArticle, starTheArticle } = useArticle();\n\n    const getArticle = async () => {\n      const { data } = await fetchArticle(id.value);\n      article.value = data;\n    };\n\n    const getComments = async () => {\n      const { data } = await fetchCommentsByArticleId(id.value);\n      commentList.value = formatToTree(data);\n    };\n\n    const collectArticle = async (isCollected: boolean, article: IArticle) => {\n      await collectTheArticle(isCollected, article);\n      await getArticle();\n    };\n\n    const starArticle = async (isStarred: boolean, article: IArticle) => {\n      await starTheArticle(isStarred, article);\n      await getArticle();\n    };\n\n    const callback = () => {\n      getComments();\n    };\n    emitter.on(UPDATE_AFTER_COMMENT_REPLY, callback);\n\n    onUnmounted(() => {\n      emitter.off(UPDATE_AFTER_COMMENT_REPLY, callback);\n    });\n\n    onMounted(() => {\n      getArticle();\n      getComments();\n    });\n\n    onActivated(() => {\n      id.value = route.params.id as string;\n      getArticle();\n      getComments();\n    });\n\n    return {\n      id,\n      article,\n      commentList,\n      collectArticle,\n      starArticle,\n      followTheUser,\n    };\n  },\n});\n","import { render } from \"./ArticleDetail.vue?vue&type=template&id=5d4052c3&scoped=true\"\nimport script from \"./ArticleDetail.vue?vue&type=script&lang=ts\"\nexport * from \"./ArticleDetail.vue?vue&type=script&lang=ts\"\n\nimport \"./ArticleDetail.vue?vue&type=style&index=0&id=5d4052c3&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-5d4052c3\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./AuthorProfileCard.vue?vue&type=style&index=0&id=2aaafe12&lang=scss&scoped=true\"","// `Symbol.prototype.description` getter\n// https://tc39.es/ecma262/#sec-symbol.prototype.description\n'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar has = require('../internals/has');\nvar isObject = require('../internals/is-object');\nvar defineProperty = require('../internals/object-define-property').f;\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\n\nvar NativeSymbol = global.Symbol;\n\nif (DESCRIPTORS && typeof NativeSymbol == 'function' && (!('description' in NativeSymbol.prototype) ||\n  // Safari 12 bug\n  NativeSymbol().description !== undefined\n)) {\n  var EmptyStringDescriptionStore = {};\n  // wrap Symbol constructor for correct work with undefined description\n  var SymbolWrapper = function Symbol() {\n    var description = arguments.length < 1 || arguments[0] === undefined ? undefined : String(arguments[0]);\n    var result = this instanceof SymbolWrapper\n      ? new NativeSymbol(description)\n      // in Edge 13, String(Symbol(undefined)) === 'Symbol(undefined)'\n      : description === undefined ? NativeSymbol() : NativeSymbol(description);\n    if (description === '') EmptyStringDescriptionStore[result] = true;\n    return result;\n  };\n  copyConstructorProperties(SymbolWrapper, NativeSymbol);\n  var symbolPrototype = SymbolWrapper.prototype = NativeSymbol.prototype;\n  symbolPrototype.constructor = SymbolWrapper;\n\n  var symbolToString = symbolPrototype.toString;\n  var native = String(NativeSymbol('test')) == 'Symbol(test)';\n  var regexp = /^Symbol\\((.*)\\)[^)]+$/;\n  defineProperty(symbolPrototype, 'description', {\n    configurable: true,\n    get: function description() {\n      var symbol = isObject(this) ? this.valueOf() : this;\n      var string = symbolToString.call(symbol);\n      if (has(EmptyStringDescriptionStore, symbol)) return '';\n      var desc = native ? string.slice(7, -1) : string.replace(regexp, '$1');\n      return desc === '' ? undefined : desc;\n    }\n  });\n\n  $({ global: true, forced: true }, {\n    Symbol: SymbolWrapper\n  });\n}\n"],"sourceRoot":""}